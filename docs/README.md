

## 区块链 blockchain
> blockchain 模块是处理 block 的组件，包括存储 block 信息，将 block 加入主链或者侧链，同步 block。同时对外提供查询 block 以及区块链状态信息的接口。主要配置区块链节点相关的配置，单节点 singleMode=true, 平行链节点isParaChain=true，其他可配置项使用默认值，也可根据具体情况自行修改
## p2p
> p2p  模块是处理节点相互通信的组件，包括节点发现并建立连接，广播区块和交易，同步区块。模块配置节点网络通信类型，以及种子节点的信息。网络类型分为 dht 和 gossip 两种，分别对应的 seed 配置也有不同。根据具体情况配置监听端口 port 和 seeds。单节点可以无需配置 p2p，使用默认值即可。

## 存储 store 模块
> 区块链存储模块，chain33 支持多种数据存储格式和数据存储驱动，一般情况用户使用默认配置即可，有需要的可以根据实际情况配置不同的存储格式和驱动。
## 账户
## 消息队列 Queue 模块
> 主要目的是为了降低chain33系统中各个模块的耦合度，引入queue模块后，每个模块相对来说独立，模块之间通信不是通过接口调用，而是通过消息进行传递。这也方便我们日后按模块拆分chain33，为后面各个模块的微服务化做铺垫。
## Rpc 模块
> Remote Procedure Call（远程过程调用）.rpc 模块主要配置 json rpc 和 grpc 的监听端口，用户根据实际情况选择，也可以在端口没有冲突的情况下选择默认值。
## 交易池 mempool 模块
> mempool 模块主要目的是为了解决共识模块可能比rpc模块速度慢的问题。主要配置交易缓存处理的策略和交易手续费，缓存策略分为 timeline，score，price，用户可根据需要选择不同的策略，其他配置一般情况下使用默认值即可。
## 共识 consensus 模块
> consensus 模块连接交易与区块的桥梁,平行链共识，PBFT，Raft，Tendermint，Ticket几种共识算法。主要配置共识方法和不同共识对应的配置。单节点使用 solo 共识，私链使用 raft 共识，联盟链使用 tendermint 共识，平行链使用 paracross 共识，不同的共识对应不同的配置。
## 钱包 wallet 模块
> wallet 主要面向钱包app提供两大服务，一个是区块链账户管理，包括账户的创建，公私钥和地址信息的管理。钱包客户端可以通过这些服务接口创建和管理账户，导出导入私钥等。另一个是交易的签名和发送，用于bty转账和智能合约交易的发送。模块主要配置账户存储路径和签名方式，签名方式支持 secp256k1, 国密 sm2， ed25519，一般情况下使用默认配置即可，如果有国密签名的需要，可以修改 signType。
## 执行器 exec 模块
> 是一个容器，它支持各种合约的运行（包括系统合约以及各种扩展合约），接收交易，并将交易分配给对应的合约具体执行，同时响应区块链上的各种事件（交易校验、查询请求、执行交易、新增区块、回滚区块），并将事件派发给具体的合约逻辑。
## health 模块
> health 模块监听一个节点是否停止服务了的功能。
## metrics 模块
## log 模块
> log 模块配置日志级别和保存，一般使用默认值即可。



```
``````````````````
``              ``
`` Client       ``
``              ``
``````````````````

``````````````````
``              ``
`` Consensus    ``
``              ``
``````````````````

``````````````````
``              ``->处理 Consensus 模块打包的区块，处理 Consensus 模块查询 block 信息的请求
`` Blockchain   ``->处理 P2P 模块接收的广播区块，向 P2P 模块发送区块进行广播，处理 P2P 模块查询 block 信息的请求
``              ``->与 Mempool，Executor 模块的交互：处理这两个模块查询区块链状态的请求
``````````````````

``````````````````
``              ``->广播 Blockchain 模块发送过来的区块，处理获取 peer 信息的请求，处理从对端下载区块和区块头的请求
`` P2p          ``->广播 Mempool 模块发送过来的交易，获取 Mempool 模块中的交易
``              ``
``````````````````

``````````````````->与 blockchain的交互
``              ``
`` Mempool      ``->与 consensus的交互
``              ``
``````````````````

``````````````````
``              ``
`` Executor     ``
``              ``
``````````````````

``````````````````
``              ``
`` Wallet     ``
``              ``
``````````````````

``````````````````->P2P、Wallet、Blockchain、Store几个模块均涉及数据存储，底层通过DB接口向KV DB实例写入及读出数据。
``              ``->Client模块也可以通过消息直接向Store发起状态数据查询。
`` Store        ``->Wallet、Consensus、Client等模块可以通过执行器，由StateDB、LocalDB对象分别向Blockchain、Store使用消息发起数据查询。
``              ``
``````````````````

``````````````````-> 消息队列
``              ``
`` Queue        ``
``              ``
``````````````````

``````````````````
``              ``
`` RPC          ``
``              ``
``````````````````

```

## 流程
一、公开记账
二、创建创世区块
三、交易
四、打包Transaction（挖矿）+ 签名Coinbase
五、广播交易（交易池管理、交易优先级排序、交易手续费定价，共识竞争与构建区块、难度调整机制、分叉处理与主链判定）
六、记账情况
## 共识机制
工作量证明（PoW，Proof of Work）算发
权益证明（PoS，Proof of Stake）
延迟工作量证明（dPoW，Delayed Proof-of-Work）
授权 PoS（DPoS，Delegated Proof-of-Stake）
权威证明（PoA，Proof-of-Authority）
权重证明（PoWeight，Proof-of-Weight）
声誉证明（PoR，Proof of Reputation）
所用时间证明（PoET，Proof of Elapsed Time）
容量证明（PoC，Proof of Capacity），也称为空间证明（PoSpace，Proof of Space）
## 加密
pki=CA[RCA(根证书)，ICA(中间证书)](公钥私钥)+CRL(证书吊销列表)
msp=联盟链证书管理
